(function () {
'use strict';

var getOffset = function (evt) {
	var el = evt.target;
	var x = 0;
	var y = 0;

	while (el && !isNaN(el.offsetLeft) && !isNaN(el.offsetTop)) {
		x += el.offsetLeft - el.scrollLeft;
		y += el.offsetTop - el.scrollTop;
		el = el.offsetParent;
	}

	x = evt.clientX - x;
	y = evt.clientY - y;

	return { x: x, y: y };
};

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* globals FaceDetector */
var StarPlusCanvas = function () {
	function StarPlusCanvas(el) {
		_classCallCheck(this, StarPlusCanvas);

		this.canvas = el;
		this.ctx = this.canvas.getContext('2d');
		this.img = null;
	}

	_createClass(StarPlusCanvas, [{
		key: 'init',
		value: function init(img) {
			this.focalPoints = [];
			this.isPlaying = false;
			this.canvas.width = Math.min(window.innerWidth, 600);
			this.canvas.height = this.canvas.width / img.width * img.height;

			this.img = img;
			img.style.display = 'none';

			this.canvas.addEventListener('click', this.addPoint.bind(this));

			this.drawImage(img);

			this.detectFaces();
		}
	}, {
		key: 'addPoint',
		value: function addPoint(e) {
			this.ctx.strokeText('x', e.layerX, e.layerY);
			this.focalPoints.push(getOffset(e));
		}
	}, {
		key: 'drawImage',
		value: function drawImage() {
			this.ctx.drawImage(this.img, 0, 0, this.img.width, this.img.height, 0, 0, this.canvas.width, this.canvas.height);
		}
	}, {
		key: 'padFocalPoints',
		value: function padFocalPoints() {
			if (this.focalPoints.length < 10) {
				for (var i = this.focalPoints.length; i < 10; i++) {
					this.focalPoints.push({
						x: Math.random() * this.canvas.width,
						y: Math.random() * this.canvas.height
					});
				}
			}
			return this.focalPoints;
		}
	}, {
		key: 'start',
		value: function start() {
			var _this = this;

			this.isPlaying = true;
			var zConf = this.padFocalPoints().map(function (pt) {
				return {
					ctx: _this.ctx,
					start: pt,
					maxIterations: Math.random() * 150 + 100,
					factor: Math.random() * 0.02 + 1.005
				};
			});

			return this.zoom(zConf[0]).then(function () {
				return _this.filter('brightness(10)', 100);
			}).then(function () {
				return _this.zoom(zConf[1]);
			}).then(function () {
				_this.filter('hue-rotate(50deg)', 400);
				return _this.zoom(zConf[2]);
			}).then(function () {
				_this.filter('hue-rotate(-50deg)', 400);
				return _this.zoom(zConf[3]);
			}).then(function () {
				return _this.zoom(zConf[4]);
			}).then(function () {
				_this.filter('invert(100%)', 300);
				return _this.zoom(zConf[5]);
			}).then(function () {
				return _this.zoom(zConf[6]);
			}).then(function () {
				_this.filter('brightness(1.2)', 400);
				return _this.zoom(zConf[7]);
			}).then(function () {
				return _this.filter('invert(100%);blur(2px)', 2000);
			}).then(function () {
				return _this.zoom(zConf[8]);
			}).then(function () {
				_this.filter('hue-rotate(120deg)', 400);
				return _this.zoom(zConf[9]);
			});
		}
	}, {
		key: 'stop',
		value: function stop() {
			this.isPlaying = false;
			this.ctx.restore();
		}
	}, {
		key: 'zoom',
		value: function zoom(opts, iterations) {
			var _this2 = this;

			this.ctx.save();
			iterations = iterations || 0;
			var doZoom = function doZoom() {
				if (!_this2.isPlaying) return;
				return new Promise(function (resolve) {
					_this2.ctx.translate(opts.start.x, opts.start.y);
					if (iterations++ < opts.maxIterations / 2) {
						_this2.ctx.scale(opts.factor, opts.factor);
					} else if (iterations < opts.maxIterations) {
						_this2.ctx.scale(1 / opts.factor, 1 / opts.factor);
					} else {
						_this2.ctx.restore();
						return resolve('asda');
					}

					_this2.ctx.translate(-opts.start.x, -opts.start.y);
					_this2.drawImage();
					requestAnimationFrame(function () {
						resolve(doZoom(opts, iterations));
					});
				});
			};

			return Promise.resolve(doZoom());
		}
	}, {
		key: 'detectFaces',
		value: function detectFaces() {
			var _this3 = this;

			if (window.FaceDetector == undefined) {
				console.error('Face Detection not supported');
				return;
			}

			var faceDetector = new FaceDetector();
			var scale = this.canvas.width / this.img.width;
			faceDetector.detect(this.img).then(function (faces) {
				// Draw the faces on the <canvas>.
				_this3.ctx.lineWidth = 2;
				_this3.ctx.strokeStyle = 'red';
				var _iteratorNormalCompletion = true;
				var _didIteratorError = false;
				var _iteratorError = undefined;

				try {
					for (var _iterator = faces[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
						var face = _step.value;

						var box = face.boundingBox;
						_this3.ctx.rect(Math.floor(box.x * scale), Math.floor(box.y * scale), Math.floor(box.width * scale), Math.floor(box.height * scale));
						_this3.ctx.stroke();
						_this3.focalPoints.push({
							x: box.x * scale,
							y: box.y * scale
						});
					}
				} catch (err) {
					_didIteratorError = true;
					_iteratorError = err;
				} finally {
					try {
						if (!_iteratorNormalCompletion && _iterator.return) {
							_iterator.return();
						}
					} finally {
						if (_didIteratorError) {
							throw _iteratorError;
						}
					}
				}
			}).catch(function (e) {
				console.error('Boo, Face Detection failed: ' + e);
			});
		}
	}, {
		key: 'filter',
		value: function filter(effect, duration) {
			var _this4 = this;

			if (!this.isPlaying) return;

			return new Promise(function (resolve) {
				_this4.ctx.filter = effect;
				_this4.drawImage();
				setTimeout(function () {
					_this4.ctx.filter = 'none';
					_this4.drawImage();
					return resolve();
				}, duration);
			});
		}
	}, {
		key: 'stream',
		get: function get() {
			return typeof this.canvas.captureStream !== 'undefined' ? this.canvas.captureStream() : null;
		}
	}]);

	return StarPlusCanvas;
}();

var _createClass$1 = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck$1(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var AudioPlayer = function () {
	function AudioPlayer() {
		_classCallCheck$1(this, AudioPlayer);

		this.audio = new Audio();
		this.audio.src = 'dramatic.mp3';
		if (typeof AudioContext === 'function') {

			this.ctx = new AudioContext();
			this.audio.oncanplay = this.setUpStream.bind(this);
		}
		this.stream = null;
	}

	_createClass$1(AudioPlayer, [{
		key: 'setUpStream',
		value: function setUpStream() {
			// create a stream from our AudioContext
			var dest = this.ctx.createMediaStreamDestination();
			this.stream = dest.stream;
			// connect our audio element's output to the stream
			var sourceNode = this.ctx.createMediaElementSource(this.audio);
			sourceNode.connect(this.ctx.destination);
			sourceNode.connect(dest);

			this.audio.oncanplay = null;
		}
	}, {
		key: 'start',
		value: function start() {
			this.audio.play();
		}
	}, {
		key: 'stop',
		value: function stop() {
			this.audio.pause();
			this.audio.currentTime = 0;
		}
	}, {
		key: 'track',
		get: function get() {
			return this.stream.getAudioTracks()[0];
		}
	}]);

	return AudioPlayer;
}();

var _createClass$2 = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck$2(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/*globals MediaRecorder */
var Recorder = function () {
	function Recorder(stream, audioPlayer) {
		_classCallCheck$2(this, Recorder);

		this.stream = stream;
		this.mediaSource = new MediaSource();
		this.mediaRecorder = null;
		this.recordedBlobs = [];
		this.sourceBuffer = null;
		this.audioPlayer = audioPlayer;
	}

	_createClass$2(Recorder, [{
		key: 'start',
		value: function start() {
			var _this = this;

			//reset the recorded blobs
			this.recordedBlobs = [];
			if (this.stream && this.stream.addTrack) {
				this.stream.addTrack(this.audioPlayer.track);
			}

			try {
				var mixedStream = 'MediaStream' in window ? new MediaStream([this.stream.getVideoTracks()[0], this.audioPlayer.track]) : this.stream;
				this.mediaRecorder = new MediaRecorder(mixedStream);
			} catch (e) {
				console.log('MediaRecorder is not supported by this browser', e);
				return;
			}

			//store the data whenever the mediarecorder gives us something
			var handleDataAvailable = function handleDataAvailable(event) {
				if (event.data && event.data.size > 0) {
					_this.recordedBlobs.push(event.data);
				}
			};

			this.mediaRecorder.ondataavailable = handleDataAvailable;

			//start recording
			this.mediaRecorder.start(100);
		}
	}, {
		key: 'stop',
		value: function stop() {
			if (this.mediaRecorder && this.mediaRecorder.state === 'recording') {
				this.mediaRecorder.stop();
			}
		}
	}, {
		key: 'download',
		value: function download() {
			var blob = new Blob(this.recordedBlobs);
			var url = window.URL.createObjectURL(blob);
			var a = document.createElement('a');
			a.style.display = 'none';
			a.href = url;
			a.download = 'star-plus.webm';
			document.body.appendChild(a);
			a.click();
			setTimeout(function () {
				document.body.removeChild(a);
				window.URL.revokeObjectURL(url);
			}, 100);
		}
	}]);

	return Recorder;
}();

var imageLoader = function (el, onLoadFn) {
	var img = new Image();

	el.addEventListener('change', function (e) {
		var reader = new FileReader();
		reader.onload = function (event) {

			img.onload = function () {
				onLoadFn(img);
			};
			img.src = event.target.result;
		};
		reader.readAsDataURL(e.target.files[0]);
	}, false);
};

var init = function init() {

	var canvasEl = document.getElementById('c');
	var imageLoaderEl = document.getElementById('imageLoader');
	var startBtn = document.getElementById('start');
	var stopBtn = document.getElementById('stop');
	var downloadBtn = document.getElementById('download');

	var spCanvas = new StarPlusCanvas(canvasEl);
	var audioPlayer = new AudioPlayer();
	var recorder = new Recorder(spCanvas.stream, audioPlayer);

	imageLoader(imageLoaderEl, spCanvas.init.bind(spCanvas));

	var stop = function stop() {
		spCanvas.stop();
		audioPlayer.stop();
		recorder.stop();
		downloadBtn.classList.add('show');
	};

	startBtn.addEventListener('click', function () {
		spCanvas.start().then(stop);
		audioPlayer.start();
		recorder.start();
		downloadBtn.classList.remove('show');
	});

	stopBtn.addEventListener('click', stop);

	downloadBtn.addEventListener('click', function () {
		recorder.download();
	});
};

init();

}());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zY3JpcHRzL3V0aWxzL2dldC1vZmZzZXQuanMiLCIuLi8uLi9zcmMvc2NyaXB0cy9zdGFyLXBsdXMtY2FudmFzLmpzIiwiLi4vLi4vc3JjL3NjcmlwdHMvYXVkaW8tcGxheWVyLmpzIiwiLi4vLi4vc3JjL3NjcmlwdHMvcmVjb3JkZXIuanMiLCIuLi8uLi9zcmMvc2NyaXB0cy9pbWFnZS1sb2FkZXIuanMiLCIuLi8uLi9zcmMvc2NyaXB0cy9tYWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGV2dCkge1xuXHRsZXQgZWwgPSBldnQudGFyZ2V0O1xuXHRsZXQgeCA9IDA7XG5cdGxldCB5ID0gMDtcblxuXHR3aGlsZSAoZWwgJiYgIWlzTmFOKGVsLm9mZnNldExlZnQpICYmICFpc05hTihlbC5vZmZzZXRUb3ApKSB7XG5cdFx0eCArPSBlbC5vZmZzZXRMZWZ0IC0gZWwuc2Nyb2xsTGVmdDtcblx0XHR5ICs9IGVsLm9mZnNldFRvcCAtIGVsLnNjcm9sbFRvcDtcblx0XHRlbCA9IGVsLm9mZnNldFBhcmVudDtcblx0fVxuXG5cdHggPSBldnQuY2xpZW50WCAtIHg7XG5cdHkgPSBldnQuY2xpZW50WSAtIHk7XG5cblx0cmV0dXJuIHsgeDogeCwgeTogeSB9O1xufSIsIi8qIGdsb2JhbHMgRmFjZURldGVjdG9yICovXG5pbXBvcnQgZ2V0T2Zmc2V0IGZyb20gJy4vdXRpbHMvZ2V0LW9mZnNldCc7XG5cbmNsYXNzIFN0YXJQbHVzQ2FudmFzIHtcblxuXHRjb25zdHJ1Y3RvciAoZWwpIHtcblx0XHR0aGlzLmNhbnZhcyA9IGVsO1xuXHRcdHRoaXMuY3R4ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblx0XHR0aGlzLmltZyA9IG51bGw7XG5cdH1cblxuXHRpbml0KGltZykge1xuXHRcdHRoaXMuZm9jYWxQb2ludHMgPSBbXTtcblx0XHR0aGlzLmlzUGxheWluZyA9IGZhbHNlO1xuXHRcdHRoaXMuY2FudmFzLndpZHRoID0gTWF0aC5taW4od2luZG93LmlubmVyV2lkdGgsIDYwMCk7XG5cdFx0dGhpcy5jYW52YXMuaGVpZ2h0ID0gdGhpcy5jYW52YXMud2lkdGggLyBpbWcud2lkdGggKiBpbWcuaGVpZ2h0O1xuIFxuXHRcdHRoaXMuaW1nID0gaW1nO1xuXHRcdGltZy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXG5cdFx0dGhpcy5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmFkZFBvaW50LmJpbmQodGhpcykpO1xuXG5cdFx0dGhpcy5kcmF3SW1hZ2UoaW1nKTtcblxuXHRcdHRoaXMuZGV0ZWN0RmFjZXMoKTtcblx0fVxuXG5cdGFkZFBvaW50KGUpIHtcblx0XHR0aGlzLmN0eC5zdHJva2VUZXh0KCd4JyxlLmxheWVyWCxlLmxheWVyWSk7XG5cdFx0dGhpcy5mb2NhbFBvaW50cy5wdXNoKGdldE9mZnNldChlKSk7XG5cdH1cblxuXHRkcmF3SW1hZ2UoKSB7XG5cdFx0dGhpcy5jdHguZHJhd0ltYWdlKHRoaXMuaW1nLCAwLCAwLCB0aGlzLmltZy53aWR0aCwgdGhpcy5pbWcuaGVpZ2h0LCAwLCAwLCB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0KTtcblx0fVxuXG5cdGdldCBzdHJlYW0oKSB7XG5cdFx0cmV0dXJuIHR5cGVvZiB0aGlzLmNhbnZhcy5jYXB0dXJlU3RyZWFtICE9PSAndW5kZWZpbmVkJyA/IHRoaXMuY2FudmFzLmNhcHR1cmVTdHJlYW0oKSA6IG51bGw7XG5cdH1cblxuXHRwYWRGb2NhbFBvaW50cygpIHtcblx0XHRpZih0aGlzLmZvY2FsUG9pbnRzLmxlbmd0aCA8IDEwKSB7XG5cdFx0XHRmb3IodmFyIGkgPSB0aGlzLmZvY2FsUG9pbnRzLmxlbmd0aDsgaTwxMDsgaSsrKSB7XG5cdFx0XHRcdHRoaXMuZm9jYWxQb2ludHMucHVzaCh7XG5cdFx0XHRcdFx0eDogTWF0aC5yYW5kb20oKSAqIHRoaXMuY2FudmFzLndpZHRoLFxuXHRcdFx0XHRcdHk6IE1hdGgucmFuZG9tKCkgKiB0aGlzLmNhbnZhcy5oZWlnaHRcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLmZvY2FsUG9pbnRzO1xuXHR9XG5cblx0c3RhcnQoKSB7XG5cdFx0dGhpcy5pc1BsYXlpbmcgPSB0cnVlO1xuXHRcdGNvbnN0IHpDb25mID0gdGhpcy5wYWRGb2NhbFBvaW50cygpLm1hcCgocHQpID0+ICh7XG5cdFx0XHRjdHg6IHRoaXMuY3R4LFxuXHRcdFx0c3RhcnQ6IHB0LFxuXHRcdFx0bWF4SXRlcmF0aW9uczogKE1hdGgucmFuZG9tKCkgKiAxNTApICsgMTAwLFxuXHRcdFx0ZmFjdG9yOiAoTWF0aC5yYW5kb20oKSAqIDAuMDIpICsgMS4wMDVcblx0XHR9KSk7XG5cblx0XHRyZXR1cm4gdGhpcy56b29tKHpDb25mWzBdKVxuXHRcdFx0LnRoZW4oKCkgPT4gdGhpcy5maWx0ZXIoJ2JyaWdodG5lc3MoMTApJywgMTAwKSlcblx0XHRcdC50aGVuKCgpID0+IHRoaXMuem9vbSh6Q29uZlsxXSkpXG5cdFx0XHQudGhlbigoKSA9PiB7XG5cdFx0XHRcdHRoaXMuZmlsdGVyKCdodWUtcm90YXRlKDUwZGVnKScsIDQwMCk7XG5cdFx0XHRcdHJldHVybiB0aGlzLnpvb20oekNvbmZbMl0pO1xuXHRcdFx0fSlcblx0XHRcdC50aGVuKCgpID0+IHtcblx0XHRcdFx0dGhpcy5maWx0ZXIoJ2h1ZS1yb3RhdGUoLTUwZGVnKScsIDQwMCk7XG5cdFx0XHRcdHJldHVybiB0aGlzLnpvb20oekNvbmZbM10pO1xuXHRcdFx0fSlcblx0XHRcdC50aGVuKCgpID0+IHRoaXMuem9vbSh6Q29uZls0XSkpXG5cdFx0XHQudGhlbigoKSA9PiB7XG5cdFx0XHRcdHRoaXMuZmlsdGVyKCdpbnZlcnQoMTAwJSknLCAzMDApO1xuXHRcdFx0XHRyZXR1cm4gdGhpcy56b29tKHpDb25mWzVdKTtcblx0XHRcdH0pXG5cdFx0XHQudGhlbigoKSA9PiB0aGlzLnpvb20oekNvbmZbNl0pKVxuXHRcdFx0LnRoZW4oKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmZpbHRlcignYnJpZ2h0bmVzcygxLjIpJywgNDAwKTtcblx0XHRcdFx0cmV0dXJuIHRoaXMuem9vbSh6Q29uZls3XSk7XG5cdFx0XHR9KVxuXHRcdFx0LnRoZW4oKCkgPT4gdGhpcy5maWx0ZXIoJ2ludmVydCgxMDAlKTtibHVyKDJweCknLCAyMDAwKSlcblx0XHRcdC50aGVuKCgpID0+IHRoaXMuem9vbSh6Q29uZls4XSkpXG5cdFx0XHQudGhlbigoKSA9PiB7XG5cdFx0XHRcdHRoaXMuZmlsdGVyKCdodWUtcm90YXRlKDEyMGRlZyknLCA0MDApO1xuXHRcdFx0XHRyZXR1cm4gdGhpcy56b29tKHpDb25mWzldKTtcblx0XHRcdH0pO1xuXHR9XG5cblx0c3RvcCgpIHtcblx0XHR0aGlzLmlzUGxheWluZyA9IGZhbHNlO1xuXHRcdHRoaXMuY3R4LnJlc3RvcmUoKTtcblx0fVxuXG5cdHpvb20gKG9wdHMsIGl0ZXJhdGlvbnMpIHtcblx0XHR0aGlzLmN0eC5zYXZlKCk7XG5cdFx0aXRlcmF0aW9ucyA9IGl0ZXJhdGlvbnMgfHwgMDtcblx0XHR2YXIgZG9ab29tID0gKCkgPT4ge1xuXHRcdFx0aWYoIXRoaXMuaXNQbGF5aW5nKSByZXR1cm47XG5cdFx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblx0XHRcdFx0dGhpcy5jdHgudHJhbnNsYXRlKG9wdHMuc3RhcnQueCxvcHRzLnN0YXJ0LnkpO1xuXHRcdFx0XHRpZihpdGVyYXRpb25zKysgPCBvcHRzLm1heEl0ZXJhdGlvbnMgLyAyKSB7XG5cdFx0XHRcdFx0dGhpcy5jdHguc2NhbGUob3B0cy5mYWN0b3IsIG9wdHMuZmFjdG9yKTtcblx0XHRcdFx0fSBlbHNlIGlmIChpdGVyYXRpb25zIDwgb3B0cy5tYXhJdGVyYXRpb25zKSB7XG5cdFx0XHRcdFx0dGhpcy5jdHguc2NhbGUoMS9vcHRzLmZhY3RvciwxL29wdHMuZmFjdG9yKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aGlzLmN0eC5yZXN0b3JlKCk7XG5cdFx0XHRcdFx0cmV0dXJuIHJlc29sdmUoJ2FzZGEnKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy5jdHgudHJhbnNsYXRlKC1vcHRzLnN0YXJ0LngsLW9wdHMuc3RhcnQueSk7XG5cdFx0XHRcdHRoaXMuZHJhd0ltYWdlKCk7XG5cdFx0XHRcdHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG5cdFx0XHRcdFx0cmVzb2x2ZShkb1pvb20ob3B0cywgaXRlcmF0aW9ucykpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH07XG5cblx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGRvWm9vbSgpKTtcblx0XHRcblx0fVxuXG5cdGRldGVjdEZhY2VzKCkge1xuXHRcdGlmICh3aW5kb3cuRmFjZURldGVjdG9yID09IHVuZGVmaW5lZCkge1xuXHRcdFx0Y29uc29sZS5lcnJvcignRmFjZSBEZXRlY3Rpb24gbm90IHN1cHBvcnRlZCcpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGNvbnN0IGZhY2VEZXRlY3RvciA9IG5ldyBGYWNlRGV0ZWN0b3IoKTtcblx0XHRjb25zdCBzY2FsZSA9IHRoaXMuY2FudmFzLndpZHRoIC8gdGhpcy5pbWcud2lkdGg7XG5cdFx0ZmFjZURldGVjdG9yLmRldGVjdCh0aGlzLmltZylcblx0XHRcdC50aGVuKGZhY2VzID0+IHtcblx0XHRcdC8vIERyYXcgdGhlIGZhY2VzIG9uIHRoZSA8Y2FudmFzPi5cblx0XHRcdFx0dGhpcy5jdHgubGluZVdpZHRoID0gMjtcblx0XHRcdFx0dGhpcy5jdHguc3Ryb2tlU3R5bGUgPSAncmVkJztcblx0XHRcdFx0Zm9yKGxldCBmYWNlIG9mIGZhY2VzKSB7XG5cdFx0XHRcdFx0Y29uc3QgYm94ID0gZmFjZS5ib3VuZGluZ0JveDtcblx0XHRcdFx0XHR0aGlzLmN0eC5yZWN0KE1hdGguZmxvb3IoYm94LnggKiBzY2FsZSksXG5cdFx0XHRcdFx0XHRNYXRoLmZsb29yKGJveC55ICogc2NhbGUpLFxuXHRcdFx0XHRcdFx0TWF0aC5mbG9vcihib3gud2lkdGggKiBzY2FsZSksXG5cdFx0XHRcdFx0XHRNYXRoLmZsb29yKGJveC5oZWlnaHQgKiBzY2FsZSkpO1xuXHRcdFx0XHRcdHRoaXMuY3R4LnN0cm9rZSgpO1xuXHRcdFx0XHRcdHRoaXMuZm9jYWxQb2ludHMucHVzaCh7XG5cdFx0XHRcdFx0XHR4OiBib3gueCAqIHNjYWxlLFxuXHRcdFx0XHRcdFx0eTogYm94LnkgKiBzY2FsZVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdC5jYXRjaCgoZSkgPT4ge1xuXHRcdFx0Y29uc29sZS5lcnJvcignQm9vLCBGYWNlIERldGVjdGlvbiBmYWlsZWQ6ICcgKyBlKTtcblx0XHR9KTtcblx0fVxuXG5cdGZpbHRlcihlZmZlY3QsIGR1cmF0aW9uKSB7XG5cdFx0aWYoIXRoaXMuaXNQbGF5aW5nKSByZXR1cm47XG5cblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblx0XHRcdHRoaXMuY3R4LmZpbHRlciA9IGVmZmVjdDtcblx0XHRcdHRoaXMuZHJhd0ltYWdlKCk7XG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0dGhpcy5jdHguZmlsdGVyID0gJ25vbmUnO1xuXHRcdFx0XHR0aGlzLmRyYXdJbWFnZSgpO1xuXHRcdFx0XHRyZXR1cm4gcmVzb2x2ZSgpO1xuXHRcdFx0fSwgZHVyYXRpb24pO1xuXHRcdH0pO1xuXHR9XG59XG5cblxuXG5cbmV4cG9ydCBkZWZhdWx0IFN0YXJQbHVzQ2FudmFzOyIsIlxuY2xhc3MgQXVkaW9QbGF5ZXIge1xuXG5cdGNvbnN0cnVjdG9yKCkge1xuXHRcdHRoaXMuYXVkaW8gPSBuZXcgQXVkaW8oKTtcblx0XHR0aGlzLmF1ZGlvLnNyYyA9ICdkcmFtYXRpYy5tcDMnO1xuXHRcdGlmKHR5cGVvZiBBdWRpb0NvbnRleHQgPT09ICdmdW5jdGlvbicpIHtcblxuXHRcdFx0dGhpcy5jdHggPSBuZXcgQXVkaW9Db250ZXh0KCk7XG5cdFx0XHR0aGlzLmF1ZGlvLm9uY2FucGxheSA9IHRoaXMuc2V0VXBTdHJlYW0uYmluZCh0aGlzKTtcblx0XHR9XG5cdFx0dGhpcy5zdHJlYW0gPSBudWxsO1xuXHR9XG5cblx0c2V0VXBTdHJlYW0oKSB7XG5cdFx0Ly8gY3JlYXRlIGEgc3RyZWFtIGZyb20gb3VyIEF1ZGlvQ29udGV4dFxuXHRcdGNvbnN0IGRlc3QgPSB0aGlzLmN0eC5jcmVhdGVNZWRpYVN0cmVhbURlc3RpbmF0aW9uKCk7XG5cdFx0dGhpcy5zdHJlYW0gPSBkZXN0LnN0cmVhbTtcblx0XHQvLyBjb25uZWN0IG91ciBhdWRpbyBlbGVtZW50J3Mgb3V0cHV0IHRvIHRoZSBzdHJlYW1cblx0XHRjb25zdCBzb3VyY2VOb2RlID0gdGhpcy5jdHguY3JlYXRlTWVkaWFFbGVtZW50U291cmNlKHRoaXMuYXVkaW8pO1xuXHRcdHNvdXJjZU5vZGUuY29ubmVjdCh0aGlzLmN0eC5kZXN0aW5hdGlvbik7XG5cdFx0c291cmNlTm9kZS5jb25uZWN0KGRlc3QpO1xuXG5cdFx0dGhpcy5hdWRpby5vbmNhbnBsYXkgPSBudWxsO1xuXG5cdH1cblxuXHRnZXQgdHJhY2soKSB7XG5cdFx0cmV0dXJuIHRoaXMuc3RyZWFtLmdldEF1ZGlvVHJhY2tzKClbMF07XG5cdH1cblxuXHRzdGFydCgpIHtcblx0XHR0aGlzLmF1ZGlvLnBsYXkoKTtcblx0fVxuXG5cdHN0b3AoKSB7XG5cdFx0dGhpcy5hdWRpby5wYXVzZSgpO1xuXHRcdHRoaXMuYXVkaW8uY3VycmVudFRpbWUgPSAwO1xuXHR9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEF1ZGlvUGxheWVyOyIsIi8qZ2xvYmFscyBNZWRpYVJlY29yZGVyICovXG5jbGFzcyBSZWNvcmRlciB7XG5cblx0Y29uc3RydWN0b3Ioc3RyZWFtLCBhdWRpb1BsYXllcikge1xuXHRcdHRoaXMuc3RyZWFtID0gc3RyZWFtO1xuXHRcdHRoaXMubWVkaWFTb3VyY2UgPSBuZXcgTWVkaWFTb3VyY2UoKTtcblx0XHR0aGlzLm1lZGlhUmVjb3JkZXIgPSBudWxsO1xuXHRcdHRoaXMucmVjb3JkZWRCbG9icyA9IFtdO1xuXHRcdHRoaXMuc291cmNlQnVmZmVyID0gbnVsbDtcblx0XHR0aGlzLmF1ZGlvUGxheWVyID0gYXVkaW9QbGF5ZXI7XG5cdH1cblxuXHRzdGFydCgpIHtcblx0XHQvL3Jlc2V0IHRoZSByZWNvcmRlZCBibG9ic1xuXHRcdHRoaXMucmVjb3JkZWRCbG9icyA9IFtdO1xuXHRcdGlmKHRoaXMuc3RyZWFtICYmIHRoaXMuc3RyZWFtLmFkZFRyYWNrKSB7XG5cdFx0XHR0aGlzLnN0cmVhbS5hZGRUcmFjayh0aGlzLmF1ZGlvUGxheWVyLnRyYWNrKTtcblx0XHR9XG5cblxuXHRcdHRyeSB7XG5cdFx0XHR2YXIgbWl4ZWRTdHJlYW0gPSAnTWVkaWFTdHJlYW0nIGluIHdpbmRvdyA/IFxuXHRcdFx0bmV3IE1lZGlhU3RyZWFtKFt0aGlzLnN0cmVhbS5nZXRWaWRlb1RyYWNrcygpWzBdLCB0aGlzLmF1ZGlvUGxheWVyLnRyYWNrXSkgOlxuXHRcdFx0dGhpcy5zdHJlYW07XG5cdFx0XHR0aGlzLm1lZGlhUmVjb3JkZXIgPSBuZXcgTWVkaWFSZWNvcmRlcihtaXhlZFN0cmVhbSk7XG5cdFx0fSBjYXRjaCAoZSkge1x0XHRcblx0XHRcdGNvbnNvbGUubG9nKCdNZWRpYVJlY29yZGVyIGlzIG5vdCBzdXBwb3J0ZWQgYnkgdGhpcyBicm93c2VyJywgZSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly9zdG9yZSB0aGUgZGF0YSB3aGVuZXZlciB0aGUgbWVkaWFyZWNvcmRlciBnaXZlcyB1cyBzb21ldGhpbmdcblx0XHRjb25zdCBoYW5kbGVEYXRhQXZhaWxhYmxlID0gKGV2ZW50KSA9PiB7XG5cdFx0XHRpZiAoZXZlbnQuZGF0YSAmJiBldmVudC5kYXRhLnNpemUgPiAwKSB7XG5cdFx0XHRcdHRoaXMucmVjb3JkZWRCbG9icy5wdXNoKGV2ZW50LmRhdGEpO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHR0aGlzLm1lZGlhUmVjb3JkZXIub25kYXRhYXZhaWxhYmxlID0gaGFuZGxlRGF0YUF2YWlsYWJsZTtcblxuXHRcdC8vc3RhcnQgcmVjb3JkaW5nXG5cdFx0dGhpcy5tZWRpYVJlY29yZGVyLnN0YXJ0KDEwMCk7XG5cdH1cblxuXHRzdG9wKCkge1xuXHRcdGlmKHRoaXMubWVkaWFSZWNvcmRlciAmJiB0aGlzLm1lZGlhUmVjb3JkZXIuc3RhdGUgPT09ICdyZWNvcmRpbmcnKSB7XG5cdFx0XHR0aGlzLm1lZGlhUmVjb3JkZXIuc3RvcCgpO1xuXHRcdH1cblx0fVxuXG5cdGRvd25sb2FkKCkge1xuXHRcdGNvbnN0IGJsb2IgPSBuZXcgQmxvYih0aGlzLnJlY29yZGVkQmxvYnMpO1xuXHRcdGNvbnN0IHVybCA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xuXHRcdGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG5cdFx0YS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdGEuaHJlZiA9IHVybDtcblx0XHRhLmRvd25sb2FkID0gJ3N0YXItcGx1cy53ZWJtJztcblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpO1xuXHRcdGEuY2xpY2soKTtcblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0ZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChhKTtcblx0XHRcdHdpbmRvdy5VUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG5cdFx0fSwgMTAwKTtcblx0fVxuXG59XG5cbmV4cG9ydCBkZWZhdWx0IFJlY29yZGVyOyIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGVsLCBvbkxvYWRGbikge1xuXHRjb25zdCBpbWcgPSBuZXcgSW1hZ2UoKTtcblxuXHRlbC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4ge1xuXHRcdGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG5cdFx0cmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKGV2ZW50KXtcblxuXHRcdFx0aW1nLm9ubG9hZCA9IGZ1bmN0aW9uKCl7XG5cdFx0XHRcdG9uTG9hZEZuKGltZyk7XG5cdFx0XHR9O1xuXHRcdFx0aW1nLnNyYyA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7XG5cdFx0fTtcblx0XHRyZWFkZXIucmVhZEFzRGF0YVVSTChlLnRhcmdldC5maWxlc1swXSk7ICAgXG5cdH0sIGZhbHNlKTtcbn0iLCJpbXBvcnQgU3RhclBsdXNDYW52YXMgZnJvbSAnLi9zdGFyLXBsdXMtY2FudmFzJztcbmltcG9ydCBBdWRpb1BsYXllciBmcm9tICcuL2F1ZGlvLXBsYXllcic7XG5pbXBvcnQgUmVjb3JkZXIgZnJvbSAnLi9yZWNvcmRlcic7XG5pbXBvcnQgaW1hZ2VMb2FkZXIgZnJvbSAnLi9pbWFnZS1sb2FkZXInO1xuXG5jb25zdCBpbml0ID0gKCkgPT4ge1xuXG5cdGNvbnN0IGNhbnZhc0VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2MnKTtcblx0Y29uc3QgaW1hZ2VMb2FkZXJFbCA9ICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW1hZ2VMb2FkZXInKTtcblx0Y29uc3Qgc3RhcnRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhcnQnKTtcblx0Y29uc3Qgc3RvcEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9wJyk7XG5cdGNvbnN0IGRvd25sb2FkQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rvd25sb2FkJyk7XG5cblx0Y29uc3Qgc3BDYW52YXMgPSBuZXcgU3RhclBsdXNDYW52YXMoY2FudmFzRWwpO1xuXHRjb25zdCBhdWRpb1BsYXllciA9IG5ldyBBdWRpb1BsYXllcigpO1xuXHRjb25zdCByZWNvcmRlciA9IG5ldyBSZWNvcmRlcihzcENhbnZhcy5zdHJlYW0sIGF1ZGlvUGxheWVyKTtcblxuXHRpbWFnZUxvYWRlcihpbWFnZUxvYWRlckVsLCBzcENhbnZhcy5pbml0LmJpbmQoc3BDYW52YXMpKTtcblxuXHRjb25zdCBzdG9wID0gKCkgPT4ge1xuXHRcdHNwQ2FudmFzLnN0b3AoKTtcblx0XHRhdWRpb1BsYXllci5zdG9wKCk7XG5cdFx0cmVjb3JkZXIuc3RvcCgpO1xuXHRcdGRvd25sb2FkQnRuLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTtcblx0fTtcblx0XG5cdHN0YXJ0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdHNwQ2FudmFzLnN0YXJ0KCkudGhlbihzdG9wKTtcblx0XHRhdWRpb1BsYXllci5zdGFydCgpO1xuXHRcdHJlY29yZGVyLnN0YXJ0KCk7XG5cdFx0ZG93bmxvYWRCdG4uY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuXHR9KTtcblxuXG5cdHN0b3BCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzdG9wKTtcblxuXHRkb3dubG9hZEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRyZWNvcmRlci5kb3dubG9hZCgpO1xuXHR9KTtcbn07XG5cbmluaXQoKTsiXSwibmFtZXMiOlsiZXZ0IiwiZWwiLCJ0YXJnZXQiLCJ4IiwieSIsImlzTmFOIiwib2Zmc2V0TGVmdCIsIm9mZnNldFRvcCIsInNjcm9sbExlZnQiLCJzY3JvbGxUb3AiLCJvZmZzZXRQYXJlbnQiLCJjbGllbnRYIiwiY2xpZW50WSIsIlN0YXJQbHVzQ2FudmFzIiwiY2FudmFzIiwiY3R4IiwiZ2V0Q29udGV4dCIsImltZyIsImZvY2FsUG9pbnRzIiwiaXNQbGF5aW5nIiwid2lkdGgiLCJNYXRoIiwibWluIiwid2luZG93IiwiaW5uZXJXaWR0aCIsImhlaWdodCIsInN0eWxlIiwiZGlzcGxheSIsImFkZEV2ZW50TGlzdGVuZXIiLCJhZGRQb2ludCIsImJpbmQiLCJkcmF3SW1hZ2UiLCJkZXRlY3RGYWNlcyIsImUiLCJzdHJva2VUZXh0IiwibGF5ZXJYIiwibGF5ZXJZIiwicHVzaCIsImdldE9mZnNldCIsImxlbmd0aCIsImkiLCJyYW5kb20iLCJ6Q29uZiIsInBhZEZvY2FsUG9pbnRzIiwibWFwIiwicHQiLCJ6b29tIiwidGhlbiIsImZpbHRlciIsInJlc3RvcmUiLCJvcHRzIiwiaXRlcmF0aW9ucyIsInNhdmUiLCJkb1pvb20iLCJQcm9taXNlIiwicmVzb2x2ZSIsInRyYW5zbGF0ZSIsInN0YXJ0IiwibWF4SXRlcmF0aW9ucyIsInNjYWxlIiwiZmFjdG9yIiwiRmFjZURldGVjdG9yIiwidW5kZWZpbmVkIiwiZXJyb3IiLCJmYWNlRGV0ZWN0b3IiLCJkZXRlY3QiLCJsaW5lV2lkdGgiLCJzdHJva2VTdHlsZSIsImZhY2VzIiwiZmFjZSIsImJveCIsImJvdW5kaW5nQm94IiwicmVjdCIsImZsb29yIiwic3Ryb2tlIiwiY2F0Y2giLCJlZmZlY3QiLCJkdXJhdGlvbiIsImNhcHR1cmVTdHJlYW0iLCJBdWRpb1BsYXllciIsImF1ZGlvIiwiQXVkaW8iLCJzcmMiLCJBdWRpb0NvbnRleHQiLCJvbmNhbnBsYXkiLCJzZXRVcFN0cmVhbSIsInN0cmVhbSIsImRlc3QiLCJjcmVhdGVNZWRpYVN0cmVhbURlc3RpbmF0aW9uIiwic291cmNlTm9kZSIsImNyZWF0ZU1lZGlhRWxlbWVudFNvdXJjZSIsImNvbm5lY3QiLCJkZXN0aW5hdGlvbiIsInBsYXkiLCJwYXVzZSIsImN1cnJlbnRUaW1lIiwiZ2V0QXVkaW9UcmFja3MiLCJSZWNvcmRlciIsImF1ZGlvUGxheWVyIiwibWVkaWFTb3VyY2UiLCJNZWRpYVNvdXJjZSIsIm1lZGlhUmVjb3JkZXIiLCJyZWNvcmRlZEJsb2JzIiwic291cmNlQnVmZmVyIiwiYWRkVHJhY2siLCJ0cmFjayIsIm1peGVkU3RyZWFtIiwiTWVkaWFTdHJlYW0iLCJnZXRWaWRlb1RyYWNrcyIsIk1lZGlhUmVjb3JkZXIiLCJsb2ciLCJoYW5kbGVEYXRhQXZhaWxhYmxlIiwiZXZlbnQiLCJkYXRhIiwic2l6ZSIsIm9uZGF0YWF2YWlsYWJsZSIsInN0YXRlIiwic3RvcCIsImJsb2IiLCJCbG9iIiwidXJsIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwiYSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImhyZWYiLCJkb3dubG9hZCIsImJvZHkiLCJhcHBlbmRDaGlsZCIsImNsaWNrIiwicmVtb3ZlQ2hpbGQiLCJyZXZva2VPYmplY3RVUkwiLCJvbkxvYWRGbiIsIkltYWdlIiwicmVhZGVyIiwiRmlsZVJlYWRlciIsIm9ubG9hZCIsInJlc3VsdCIsInJlYWRBc0RhdGFVUkwiLCJmaWxlcyIsImluaXQiLCJjYW52YXNFbCIsImdldEVsZW1lbnRCeUlkIiwiaW1hZ2VMb2FkZXJFbCIsInN0YXJ0QnRuIiwic3RvcEJ0biIsImRvd25sb2FkQnRuIiwic3BDYW52YXMiLCJyZWNvcmRlciIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSJdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsZ0JBQWUsVUFBU0EsR0FBVCxFQUFjO0tBQ3hCQyxLQUFLRCxJQUFJRSxNQUFiO0tBQ0lDLElBQUksQ0FBUjtLQUNJQyxJQUFJLENBQVI7O1FBRU9ILE1BQU0sQ0FBQ0ksTUFBTUosR0FBR0ssVUFBVCxDQUFQLElBQStCLENBQUNELE1BQU1KLEdBQUdNLFNBQVQsQ0FBdkMsRUFBNEQ7T0FDdEROLEdBQUdLLFVBQUgsR0FBZ0JMLEdBQUdPLFVBQXhCO09BQ0tQLEdBQUdNLFNBQUgsR0FBZU4sR0FBR1EsU0FBdkI7T0FDS1IsR0FBR1MsWUFBUjs7O0tBR0dWLElBQUlXLE9BQUosR0FBY1IsQ0FBbEI7S0FDSUgsSUFBSVksT0FBSixHQUFjUixDQUFsQjs7UUFFTyxFQUFFRCxHQUFHQSxDQUFMLEVBQVFDLEdBQUdBLENBQVgsRUFBUDs7Ozs7Ozs7QUNiRCxJQUVNUzt5QkFFUVosRUFBYixFQUFpQjs7O09BQ1hhLE1BQUwsR0FBY2IsRUFBZDtPQUNLYyxHQUFMLEdBQVcsS0FBS0QsTUFBTCxDQUFZRSxVQUFaLENBQXVCLElBQXZCLENBQVg7T0FDS0MsR0FBTCxHQUFXLElBQVg7Ozs7O3VCQUdJQSxLQUFLO1FBQ0pDLFdBQUwsR0FBbUIsRUFBbkI7UUFD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
